<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>ANRç¨‹åºé—®é¢˜åˆ†æä¹‹dropbox | å°éº¦</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="https://unpkg.com/normalize.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/pure-min.css"><link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="https://unpkg.com/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/blog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/blog/atom.xml"><script src="https://www.googletagmanager.com/gtag/js?id=G-R3NLYDC8PK" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-R3NLYDC8PK');
</script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "n85h4t74i7");
</script><script type="text/javascript" src="https://unpkg.com/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="https://unpkg.com/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="https://unpkg.com/toastr/build/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ANRç¨‹åºé—®é¢˜åˆ†æä¹‹dropbox</h1><a id="logo" href="/blog/.">å°éº¦</a><p class="description">äººç”Ÿçš„å¤§èµ·å¤§è½æ¥å¾—å¤ªçªç„¶ï¼Œæå¾—æˆ‘ç›´æƒ³å°¿å°¿...</p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/blog/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/blog/history/"><i class="fa fa-book"> å†å²</i></a><a href="/blog/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/blog/guestbook/"><i class="fa fa-comments"> ç•™è¨€</i></a><a href="/blog/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ANRç¨‹åºé—®é¢˜åˆ†æä¹‹dropbox</h1><div class="post-meta">2018-07-14<span> | </span><span class="category"><a href="/blog/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/">æŠ€æœ¯åˆ†äº«</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.7k</span><span class="post-meta-item-text"> å­—</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 12</span><span class="post-meta-item-text"> åˆ†é’Ÿ</span></span></span></div><a class="disqus-comment-count" href="/blog/2018/07/14/anr-cheng-xu-wen-ti-fen-xi-zhi-dropbox/#vcomment"><span class="valine-comment-count" data-xid="/blog/2018/07/14/anr-cheng-xu-wen-ti-fen-xi-zhi-dropbox/"></span><span> æ¡è¯„è®º</span></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">æ–‡ç« ç›®å½•</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#DropBox%E5%90%AF%E5%8A%A8"><span class="toc-number">1.</span> <span class="toc-text">DropBoxå¯åŠ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DropBox%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">2.</span> <span class="toc-text">DropBoxåˆå§‹åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#init-%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">init()æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#trimToFit-%E6%96%B9%E6%B3%95"><span class="toc-number">2.2.</span> <span class="toc-text">trimToFit()æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DropBox%E5%B7%A5%E4%BD%9C"><span class="toc-number">3.</span> <span class="toc-text">DropBoxå·¥ä½œ</span></a></li></ol></div></div><div class="post-content"><p>ä»2.2å¼€å§‹å¢åŠ äº†DropBoxåŠŸèƒ½ï¼Œå¢å¼ºAndroidçš„å¼‚å¸¸ä¿¡æ¯æ”¶é›†ç®¡ç†èƒ½åŠ›DropBoxï¼ˆç®€ç§°DBï¼‰æ˜¯ç³»ç»Ÿè¿›ç¨‹ä¸­çš„ä¸€ä¸ªæœåŠ¡ï¼Œåœ¨system_serverè¿›ç¨‹å¯åŠ¨æ—¶åˆ›å»ºï¼Œå¹¶ä¸”å®ƒæ²¡æœ‰è¿è¡Œåœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­ï¼Œè€Œæ˜¯è¿è¡Œåœ¨system_serverçš„ServerThreadçº¿ç¨‹ä¸­ã€‚æˆ‘ä»¬å¯ä»¥å°†ServerThreadç§°ä½œsystem_serverçš„ä¸»çº¿ç¨‹ï¼ŒServerThreadçº¿ç¨‹é™¤äº†å¯åŠ¨å¹¶ç»´æŠ¤å„ä¸ªæœåŠ¡å¤–ï¼Œè¿˜è´Ÿè´£æ£€æµ‹ä¸€äº›é‡è¦çš„æœåŠ¡æ˜¯å¦æ­»é”<br>DropBoxManagerServiceï¼ˆç®€ç§°DBMSï¼‰å°±æ˜¯DBæœåŠ¡çš„æœ¬å°Šï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½æ¥å£åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªå‡½æ•°ï¼š<br>public voidadd(DropBoxManager.Entryentry)</p>
<p>DBMSå°†æ‰€æœ‰è¦æ·»åŠ çš„æ—¥å¿—éƒ½ç”¨DropBoxManager.Entryç±»å‹çš„å¯¹è±¡è¡¨ç¤ºï¼Œé€šè¿‡addå‡½æ•°æ·»åŠ ï¼Œå¹¶ä¸”ç›´åˆ°ç›®å‰ä¸ºæ­¢ä¸€ä¸ªEntryå¯¹è±¡å¯¹åº”ç€ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚</p>
<p>publicboolean isTagEnabled(String tag)</p>
<p>é€šè¿‡ç»™æ¯ä¸€ä¸ªEntryè®¾ç½®ä¸€ä¸ªtagå¯ä»¥æ ‡è¯†ä¸åŒç±»å‹çš„æ—¥å¿—ï¼Œå¹¶ä¸”å¯ä»¥çµæ´»çš„å¯ç”¨&#x2F;ç¦ç”¨æŸç§ç±»å‹çš„æ—¥å¿—ï¼ŒisTagEnabledç”¨æ¥åˆ¤æ–­æŒ‡å®šç±»å‹çš„æ—¥å¿—æ˜¯å¦è¢«å¯ç”¨&#x2F;ç¦ç”¨äº†ï¼Œä¸€æ—¦ç¦ç”¨å°±ä¸ä¼šå†è®°å½•è¿™ç§ç±»å‹çš„æ—¥å¿—ã€‚é»˜è®¤æ˜¯ä¸ç¦ç”¨ä»»ä½•ç±»å‹çš„æ—¥å¿—çš„ã€‚ç¨åè¯´æ˜å¦‚ä½•å¯ç”¨&#x2F;ç¦ç”¨æ—¥å¿—ã€‚</p>
<p>publicsynchronized DropBoxManager.Entry getNextEntry(String tag, long millis)</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡getNextEntryå‡½æ•°è·å–æŒ‡å®šç±»å‹å’ŒæŒ‡å®šæ—¶é—´ç‚¹ä¹‹åçš„ç¬¬ä¸€æ¡æ—¥å¿—ï¼Œè¦ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½åº”ç”¨ç¨‹åºéœ€è¦æœ‰â€œandroid.permission.READ_LOGSâ€çš„æƒé™ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨å®Œæ¯•è¿”å›çš„Entryå¯¹è±¡åè¦è°ƒç”¨å…¶closeå‡½æ•°ç¡®ä¿å…³é—­æ—¥å¿—æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆå¦‚æœä¸å…³é—­çš„è¯å¯èƒ½é€ æˆè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦è¶…è¿‡1024è€Œå´©æºƒï¼ŒAndroidä¸­é™åˆ¶æ¯ä¸ªè¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦ä¸Šé™ä¸º1024ï¼‰ã€‚</p>
<p>DBMSæä¾›äº†å¾ˆå¤šçš„é…ç½®é¡¹ç”¨æ¥é™åˆ¶å¯¹ç£ç›˜çš„ä½¿ç”¨ï¼Œé€šè¿‡SettingsProvideråº”ç”¨ç¨‹åºç»´æŠ¤ï¼Œæ•°æ®å­˜æ”¾åœ¨å…¶settings.dbæ•°æ®åº“ä¸­ã€‚è¿™äº›é…ç½®é¡¹ä¹Ÿéƒ½æœ‰é»˜è®¤å€¼ï¼Œç½—åˆ—å¦‚ä¸‹ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Settings<span class="selector-class">.Secure</span><span class="selector-class">.DROPBOX_AGE_SECONDS</span> = <span class="string">&quot;dropbox_age_seconds&quot;</span></span><br><span class="line"><span class="comment">//æ—¥å¿—æ–‡ä»¶ä¿å­˜çš„æœ€é•¿æ—¶é—´ï¼Œé»˜è®¤3å¤©</span></span><br><span class="line">Settings<span class="selector-class">.Secure</span><span class="selector-class">.DROPBOX_MAX_FILES</span> = <span class="string">&quot;dropbox_max_files&quot;</span></span><br><span class="line"><span class="comment">//æ—¥å¿—æ–‡ä»¶çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤å€¼æ˜¯1000</span></span><br><span class="line">Settings<span class="selector-class">.Secure</span><span class="selector-class">.DROPBOX_QUOTA_KB</span> = <span class="string">&quot;dropbox_quota_kb&quot;</span></span><br><span class="line"><span class="comment">//ç£ç›˜ç©ºé—´æœ€å¤§ä½¿ç”¨é‡</span></span><br><span class="line">Settings<span class="selector-class">.Secure</span><span class="selector-class">.DROPBOX_QUOTA_PERCENT</span> = <span class="string">&quot;dropbox_quota_percent&quot;</span></span><br><span class="line">Settings<span class="selector-class">.Secure</span><span class="selector-class">.DROPBOX_RESERVE_PERCENT</span> = <span class="string">&quot;dropbox_reserve_percent&quot;</span></span><br><span class="line">Settings<span class="selector-class">.Secure</span><span class="selector-class">.DROPBOX_TAG_PREFIX</span> = <span class="string">&quot;dropbox:&quot;</span></span><br><span class="line"><span class="comment">//åº”ç”¨ç¨‹åºå¯ä»¥åˆ©ç”¨DropBoxæ¥åšäº‹æƒ…ï¼Œæ”¶é›†æ—¥å¿—ç­‰</span></span><br></pre></td></tr></table></figure>
<h3 id="DropBoxå¯åŠ¨"><a href="#DropBoxå¯åŠ¨" class="headerlink" title="DropBoxå¯åŠ¨"></a>DropBoxå¯åŠ¨</h3><p>åœ¨SystemServer.javaçš„ServerThread.run()é‡Œ</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Slog.i(TAG, <span class="string">&quot;DropBox Service&quot;</span>);</span><br><span class="line">ServiceManager.addService(<span class="keyword">Context</span>.DROPBOX_SERVICE, //æœåŠ¡åç§°ä¸ºâ€œdropboxâ€</span><br><span class="line"><span class="keyword">new</span> DropBoxManagerService(<span class="keyword">context</span>, <span class="keyword">new</span> <span class="keyword">File</span>(<span class="string">&quot;/data/system/dropbox&quot;</span>)));</span><br></pre></td></tr></table></figure>
<p>DROPBOX_SERVICE &#x3D; â€œdropboxâ€, â€œ&#x2F;data&#x2F;system&#x2F;dropboxâ€æ˜¯DBæŒ‡å®šçš„æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼Œè¿™ä¸ªè¿‡ç¨‹å‘ServiceManager ç™»è®°åä¸ºâ€œdropboxâ€çš„æœåŠ¡ã€‚é‚£ä¹ˆå¯é€šè¿‡<code>dumpsys dropbox</code>æ¥æŸ¥çœ‹è¯¥dropboxæœåŠ¡ä¿¡æ¯ã€‚</p>
<h3 id="DropBoxåˆå§‹åŒ–"><a href="#DropBoxåˆå§‹åŒ–" class="headerlink" title="DropBoxåˆå§‹åŒ–"></a>DropBoxåˆå§‹åŒ–</h3><p>åœ¨DropBoxManagerService.javaçš„æ„é€ æ–¹æ³•é‡Œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">DropBoxManagerService</span> <span class="keyword">extends</span> <span class="title class_">IDropBoxManagerService</span>.Stub &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DropBoxManagerService</span><span class="params">(<span class="keyword">final</span> Context context, File path)</span> &#123;</span><br><span class="line">        mDropBoxDir = path;  <span class="comment">// ç›®å½•/data/system/dropbox</span></span><br><span class="line">        mContext = context;</span><br><span class="line">        mContentResolver = context.getContentResolver();</span><br><span class="line"></span><br><span class="line">        <span class="type">IntentFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntentFilter</span>();</span><br><span class="line">        <span class="comment">// ç›‘å¬å­˜å‚¨è®¾å¤‡å¯ç”¨ç©ºé—´ä½çš„å¹¿æ’­</span></span><br><span class="line">        filter.addAction(Intent.ACTION_DEVICE_STORAGE_LOW);</span><br><span class="line">        <span class="comment">// ç›‘å¬å¼€æœºå®Œæ¯•çš„å¹¿æ’­</span></span><br><span class="line">        filter.addAction(Intent.ACTION_BOOT_COMPLETED);</span><br><span class="line">        context.registerReceiver(mReceiver, filter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Settingsæ•°æ®åº“å˜åŒ–æ—¶åˆ™å›è°ƒå¹¿æ’­æ¥æ”¶è€…çš„onReceiveæ–¹æ³•,æ­¤å¤„CONTENT_URI=content://settings/global&quot;</span></span><br><span class="line">        mContentResolver.registerContentObserver(</span><br><span class="line">            Settings.Global.CONTENT_URI, <span class="literal">true</span>,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ContentObserver</span>(<span class="keyword">new</span> <span class="title class_">Handler</span>()) &#123;</span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onChange</span><span class="params">(<span class="type">boolean</span> selfChange)</span> &#123;</span><br><span class="line">                    mReceiver.onReceive(context, (Intent) <span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        mHandler = <span class="keyword">new</span> <span class="title class_">Handler</span>() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">                <span class="comment">// å‘é€å¹¿æ’­</span></span><br><span class="line">                <span class="keyword">if</span> (msg.what == MSG_SEND_BROADCAST) &#123;</span><br><span class="line">                    mContext.sendBroadcastAsUser((Intent)msg.obj, UserHandle.OWNER,</span><br><span class="line">                            android.Manifest.permission.READ_LOGS);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•ä¸»è¦åŠŸèƒ½æ˜¯ç»™dropboxç›®å½•æ‰€å¯¹åº”çš„å­˜å‚¨ç©ºé—´è¿›è¡Œç˜¦èº«:</p>
<ul>
<li>å­˜å‚¨è®¾å¤‡å¯ç”¨ç©ºé—´ä½ï¼›</li>
<li>å¼€æœºå®Œæ¯•ï¼›</li>
<li>Settingsæ•°æ®åº“å˜åŒ–ï¼›<br>ä»¥ä¸Šæƒ…å†µéƒ½ä¼šè§¦å‘è§¦å‘æ‰§è¡ŒmReceiverçš„onReceiveæ–¹æ³•<br>åœ¨DropBoxManagerService.javaçš„mReceiver<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> final BroadcastReceiver mReceiver = <span class="keyword">new</span> BroadcastReceiver() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span>(<span class="params">Context context, Intent intent</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (intent != <span class="literal">null</span> &amp;&amp; Intent.ACTION_BOOT_COMPLETED.<span class="keyword">equals</span>(intent.getAction())) &#123;</span><br><span class="line">            mBooted = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ”¶åˆ°ACTION_DEVICE_STORAGE_LOWï¼Œåˆ™å¼ºåˆ¶é‡æ–°checkå­˜å‚¨ç©ºé—´</span></span><br><span class="line">        mCachedQuotaUptimeMillis = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œinitå’Œtrimæ“ä½œ</span></span><br><span class="line">        <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span>()</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">init</span>(); <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">                    trimToFit(); <span class="comment">//æ¸…é™¤ä¸€äº›ç©ºé—´</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    ...</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="init-æ–¹æ³•"><a href="#init-æ–¹æ³•" class="headerlink" title="init()æ–¹æ³•"></a>init()æ–¹æ³•</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> init() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">if</span> (mStatFs == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mDropBoxDir.isDirectory() &amp;&amp; !mDropBoxDir.mkdirs()) &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">        mStatFs = <span class="keyword">new</span> StatFs(mDropBoxDir.getPath());</span><br><span class="line">        mBlockSize = mStatFs.getBlockSize(); <span class="comment">//mBlockSize=4096</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mAllFiles == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">File</span>[] files = mDropBoxDir.listFiles();</span><br><span class="line">        <span class="comment">// åˆ—ä¸¾æ‰€æœ‰çš„dropboxæ–‡ä»¶</span></span><br><span class="line">        mAllFiles = <span class="keyword">new</span> FileList();</span><br><span class="line">        mFilesByTag = <span class="keyword">new</span> HashMap&lt;String, FileList&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">File</span> <span class="keyword">file</span> : files) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">file</span>.getName().endsWith(<span class="string">&quot;.tmp&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">file</span>.<span class="keyword">delete</span>(); <span class="comment">//åˆ é™¤åç¼€ä¸º.tmpæ–‡ä»¶</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// åˆ›å»ºdropboxçš„å®ä½“æ–‡ä»¶å¯¹è±¡, æ ¹æ®æ–‡ä»¶åæ¥è·å–ç›¸åº”çš„æ—¶é—´æˆ³</span></span><br><span class="line">            EntryFile entry = <span class="keyword">new</span> EntryFile(<span class="keyword">file</span>, mBlockSize);</span><br><span class="line">            <span class="keyword">if</span> (entry.tag == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>; <span class="comment">//å¿½ç•¥tagä¸ºç©ºçš„æ–‡ä»¶</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (entry.timestampMillis == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">file</span>.<span class="keyword">delete</span>(); <span class="comment">//åˆ é™¤æ—¶é—´æˆ³ä¸º0çš„æ–‡ä»¶</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†entryåŠ å…¥åˆ°mAllFileså¯¹è±¡</span></span><br><span class="line">            enrollEntry(entry);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•ä¸»è¦åŠŸèƒ½ï¼š</p>
<ul>
<li>åˆ›å»ºç›®å½•&#x2F;data&#x2F;system&#x2F;dropbox;</li>
<li>å°†æ¯ä¸€ä¸ªdropboxæ–‡ä»¶éƒ½å¯¹åº”äºä¸€ä¸ªEntryFileå¯¹è±¡,æ ¹æ®æ–‡ä»¶åæ¥è·å–ç›¸åº”çš„æ—¶é—´æˆ³</li>
<li>åˆ é™¤åç¼€ä¸º.tmpçš„æ–‡ä»¶;</li>
<li>åˆ é™¤æ—¶é—´æˆ³ä¸º0çš„æ–‡ä»¶</li>
</ul>
<h4 id="trimToFit-æ–¹æ³•"><a href="#trimToFit-æ–¹æ³•" class="headerlink" title="trimToFit()æ–¹æ³•"></a>trimToFit()æ–¹æ³•</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">long</span> trimToFit() &#123;</span><br><span class="line">    <span class="keyword">int</span> ageSeconds = Settings.Global.getInt(mContentResolver,</span><br><span class="line">            Settings.Global.DROPBOX_AGE_SECONDS, DEFAULT_AGE_SECONDS);</span><br><span class="line">    <span class="keyword">int</span> maxFiles = Settings.Global.getInt(mContentResolver,</span><br><span class="line">            Settings.Global.DROPBOX_MAX_FILES, DEFAULT_MAX_FILES);</span><br><span class="line">    <span class="keyword">long</span> cutoffMillis = System.currentTimeMillis() - ageSeconds * <span class="number">1000</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (!mAllFiles.contents.isEmpty()) &#123;</span><br><span class="line">        EntryFile entry = mAllFiles.contents.first();</span><br><span class="line">        <span class="comment">//å½“æœ€è€çš„æ–‡ä»¶æ—¶é—´æˆ³åœ¨3å¤©ä¹‹å†…ï¼Œä¸”æ–‡ä»¶ä¸ªæ•°ä½äº1000ï¼Œåˆ™è·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">if</span> (entry.timestampMillis &gt; cutoffMillis </span><br><span class="line">            &amp;&amp; mAllFiles.contents.<span class="keyword">size</span>() &lt; maxFiles) <span class="keyword">break</span>;</span><br><span class="line">        FileList tag = mFilesByTag.get(entry.tag);</span><br><span class="line">        <span class="keyword">if</span> (tag != <span class="keyword">null</span> &amp;&amp; tag.contents.remove(entry)) tag.blocks -= entry.blocks;</span><br><span class="line">        <span class="keyword">if</span> (mAllFiles.contents.remove(entry)) mAllFiles.blocks -= entry.blocks;</span><br><span class="line">        <span class="keyword">if</span> (entry.<span class="keyword">file</span> != <span class="keyword">null</span>) entry.<span class="keyword">file</span>.<span class="keyword">delete</span>(); <span class="comment">//åˆ é™¤æ–‡ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> uptimeMillis = SystemClock.uptimeMillis();</span><br><span class="line">    <span class="comment">//é™¤éæ¥æ”¶è®¾å¤‡å­˜å‚¨ä½çš„å¹¿æ’­ï¼Œå¦åˆ™é—´éš”5sæ‰èƒ½å†æ¬¡æ‰§è¡Œrestat</span></span><br><span class="line">    <span class="keyword">if</span> (uptimeMillis &gt; mCachedQuotaUptimeMillis + QUOTA_RESCAN_MILLIS) &#123;</span><br><span class="line">        <span class="keyword">int</span> quotaPercent = Settings.Global.getInt(mContentResolver,</span><br><span class="line">                Settings.Global.DROPBOX_QUOTA_PERCENT, DEFAULT_QUOTA_PERCENT);</span><br><span class="line">        <span class="keyword">int</span> reservePercent = Settings.Global.getInt(mContentResolver,</span><br><span class="line">                Settings.Global.DROPBOX_RESERVE_PERCENT, DEFAULT_RESERVE_PERCENT);</span><br><span class="line">        <span class="keyword">int</span> quotaKb = Settings.Global.getInt(mContentResolver,</span><br><span class="line">                Settings.Global.DROPBOX_QUOTA_KB, DEFAULT_QUOTA_KB);</span><br><span class="line">        <span class="comment">//é‡æ–°ç»Ÿè®¡æ–‡ä»¶</span></span><br><span class="line">        mStatFs.restat(mDropBoxDir.getPath());</span><br><span class="line">        <span class="keyword">int</span> available = mStatFs.getAvailableBlocks();</span><br><span class="line">        <span class="keyword">int</span> nonreserved = available - mStatFs.getBlockCount() * reservePercent / <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">int</span> maximum = quotaKb * <span class="number">1024</span> / mBlockSize;</span><br><span class="line">        <span class="comment">//å¯ç”¨çš„å—æ•°é‡</span></span><br><span class="line">        mCachedQuotaBlocks = Math.min(maximum, Math.max(<span class="number">0</span>, nonreserved * quotaPercent / <span class="number">100</span>));</span><br><span class="line">        mCachedQuotaUptimeMillis = uptimeMillis;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mAllFiles.blocks &gt; mCachedQuotaBlocks) &#123;</span><br><span class="line">        <span class="comment">//å…¬å¹³åœ°é™åˆ¶æ‰€æœ‰tagçš„ç©ºé—´</span></span><br><span class="line">        <span class="keyword">int</span> unsqueezed = mAllFiles.blocks, squeezed = <span class="number">0</span>;</span><br><span class="line">        TreeSet&lt;FileList&gt; tags = <span class="keyword">new</span> TreeSet&lt;FileList&gt;(mFilesByTag.values());</span><br><span class="line">        <span class="keyword">for</span> (FileList tag : tags) &#123;</span><br><span class="line">            <span class="keyword">if</span> (squeezed &gt; <span class="number">0</span> &amp;&amp; tag.blocks &lt;= (mCachedQuotaBlocks - unsqueezed) / squeezed) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            unsqueezed -= tag.blocks;</span><br><span class="line">            squeezed++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> tagQuota = (mCachedQuotaBlocks - unsqueezed) / squeezed;</span><br><span class="line">        <span class="comment">//ç§»é™¤æ¯ä¸ªtagsä¸­çš„æ—§items</span></span><br><span class="line">        <span class="keyword">for</span> (FileList tag : tags) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mAllFiles.blocks &lt; mCachedQuotaBlocks) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">while</span> (tag.blocks &gt; tagQuota &amp;&amp; !tag.contents.isEmpty()) &#123;</span><br><span class="line">                EntryFile entry = tag.contents.first();</span><br><span class="line">                <span class="keyword">if</span> (tag.contents.remove(entry)) tag.blocks -= entry.blocks;</span><br><span class="line">                <span class="keyword">if</span> (mAllFiles.contents.remove(entry)) mAllFiles.blocks -= entry.blocks;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (entry.<span class="keyword">file</span> != <span class="keyword">null</span>) entry.<span class="keyword">file</span>.<span class="keyword">delete</span>();</span><br><span class="line">                    enrollEntry(<span class="keyword">new</span> EntryFile(mDropBoxDir, entry.tag, entry.timestampMillis));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    Slog.e(TAG, <span class="string">&quot;Can&#x27;t write tombstone file&quot;</span>, e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mCachedQuotaBlocks * mBlockSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>trimToFitè¿‡ç¨‹ä¸­è§¦å‘æ¡ä»¶æ˜¯ï¼šå½“æ–‡ä»¶æœ‰æ•ˆæ—¶é•¿è¶…è¿‡3å¤©ï¼Œæˆ–è€…æœ€å¤§æ–‡ä»¶æ•°è¶…è¿‡1000ï¼Œå†æˆ–è€…å‰©ä½™å¯ç”¨å­˜å‚¨è®¾å¤‡è¿‡ä½ï¼›<br>DBMSæœ‰å¾ˆå¤šå¸¸é‡å‚æ•°ï¼š</p>
<ul>
<li>DEFAULT_AGE_SECONDS &#x3D; 3 * 86400ï¼šæ–‡ä»¶æœ€é•¿å¯å­˜æ´»æ—¶é•¿ä¸º3å¤©</li>
<li>DEFAULT_MAX_FILES &#x3D; 1000ï¼šæœ€å¤§dropboxæ–‡ä»¶ä¸ªæ•°ä¸º1000</li>
<li>DEFAULT_QUOTA_KB &#x3D; 5 * 1024ï¼šåˆ†é…dropboxç©ºé—´çš„æœ€å¤§å€¼5M</li>
<li>DEFAULT_QUOTA_PERCENT &#x3D; 10ï¼šæ˜¯æŒ‡dropboxç›®å½•æœ€å¤šå¯å ç”¨ç©ºé—´æ¯”ä¾‹10%</li>
<li>DEFAULT_RESERVE_PERCENT &#x3D; 10ï¼šæ˜¯æŒ‡dropboxä¸å¯ä½¿ç”¨çš„å­˜å‚¨ç©ºé—´æ¯”ä¾‹10%</li>
<li>QUOTA_RESCAN_MILLIS &#x3D; 5000ï¼šé‡æ–°æ‰«æretrimæ—¶é•¿ä¸º5s<br>å½“ç„¶ä¸Šé¢è¿™äº›éƒ½æ˜¯é»˜è®¤å€¼ï¼Œå®Œå…¨å¯ä»¥é€šè¿‡è®¾ç½®content:&#x2F;&#x2F;settings&#x2F;globalæ•°æ®åº“ä¸­ç›¸åº”é¡¹æ¥è®¾å®šå€¼ã€‚</li>
</ul>
<h3 id="DropBoxå·¥ä½œ"><a href="#DropBoxå·¥ä½œ" class="headerlink" title="DropBoxå·¥ä½œ"></a>DropBoxå·¥ä½œ</h3><p>ä»¥ä¸‹ä»»ä¸€åœºæ™¯ï¼Œéƒ½ä¼šè°ƒç”¨AMS.addErrorToDropBox()æ¥è§¦å‘DBMSå·¥ä½œã€‚</p>
<ul>
<li>crash: AMS.handleApplicationCrashInner()</li>
<li>anr: AMS.appNotResponding()</li>
<li>watchdog: Watchdog.run()</li>
<li>native_crash: NativeCrashReporter.run()</li>
<li>wtf: å½“è°ƒç”¨Log.wtf()æˆ–è€…Log.wtfQuiet()</li>
<li>lowmem: å½“å†…å­˜è¾ƒä½æ—¶ï¼Œè§¦å‘AMS.reportMemUsage()</li>
</ul>
<p>åœ¨ActivityManagerService.javaçš„addErrorToDropBox()æ–¹æ³•</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> addErrorToDropBox(String eventType, ProcessRecord process, String processName, ActivityRecord activity, ActivityRecord parent, String subject, <span class="keyword">final</span> String report, <span class="keyword">final</span> <span class="keyword">File</span> logFile, <span class="keyword">final</span> ApplicationErrorReport.CrashInfo crashInfo) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºdropboxæ ‡ç­¾å</span></span><br><span class="line">    <span class="keyword">final</span> String dropboxTag = processClass(process) + <span class="string">&quot;_&quot;</span> + eventType;</span><br><span class="line">    <span class="comment">//è·å–dropboxæœåŠ¡çš„ä»£ç†ç«¯</span></span><br><span class="line">    <span class="keyword">final</span> DropBoxManager dbox = (DropBoxManager)</span><br><span class="line">            mContext.getSystemService(Context.DROPBOX_SERVICE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å½“ä¸éœ€è¦è¾“å‡ºdropboxæŠ¥å‘Šåˆ™ç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> (dbox == <span class="keyword">null</span> || !dbox.isTagEnabled(dropboxTag)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="number">1024</span>);</span><br><span class="line">    <span class="comment">//è¾“å‡ºProcess,flags,ä»¥åŠè¿›ç¨‹ä¸­æ‰€æœ‰package</span></span><br><span class="line">    appendDropBoxProcessHeaders(process, processName, sb);</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (subject != <span class="keyword">null</span>) &#123;</span><br><span class="line">        sb.<span class="keyword">append</span>(<span class="string">&quot;Subject: &quot;</span>).<span class="keyword">append</span>(subject).<span class="keyword">append</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sb.<span class="keyword">append</span>(<span class="string">&quot;Build: &quot;</span>).<span class="keyword">append</span>(Build.FINGERPRINT).<span class="keyword">append</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    sb.<span class="keyword">append</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºæ–°çº¿ç¨‹ï¼Œé¿å…å°†è°ƒç”¨è€…é˜»å¡åœ¨I/O</span></span><br><span class="line">    Thread worker = <span class="keyword">new</span> Thread(<span class="string">&quot;Error dump: &quot;</span> + dropboxTag) &#123;</span><br><span class="line">        @Override</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> run() &#123;</span><br><span class="line">            <span class="keyword">if</span> (report != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//æ¯”å¦‚ANRæ—¶è¾“å‡ºCpuinfoï¼Œæˆ–è€…lowmemæ—¶è¾“å‡ºçš„å†…å­˜ä¿¡æ¯</span></span><br><span class="line">                sb.<span class="keyword">append</span>(report); </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (logFile != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//æ¯”å¦‚anræˆ–è€…Watchdogæ—¶è¾“å‡ºçš„tracesæ–‡ä»¶(kill -3)ï¼Œæœ€å¤§ä¸Šé™ä¸º256KB</span></span><br><span class="line">                sb.<span class="keyword">append</span>(FileUtils.readTextFile(logFile, DROPBOX_MAX_SIZE,</span><br><span class="line">                            <span class="string">&quot;\n\n[[TRUNCATED]]&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (crashInfo != <span class="keyword">null</span> &amp;&amp; crashInfo.stackTrace != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// æ¯”å¦‚crashæ—¶è¾“å‡ºçš„è°ƒç”¨æ ˆ</span></span><br><span class="line">                sb.<span class="keyword">append</span>(crashInfo.stackTrace);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String setting = Settings.Global.ERROR_LOGCAT_PREFIX + dropboxTag;</span><br><span class="line">            <span class="keyword">int</span> lines = Settings.Global.getInt(mContext.getContentResolver(), setting, <span class="number">0</span>);</span><br><span class="line">            <span class="comment">//å½“dropboxTagæ‰€å¯¹åº”çš„settingsé¡¹ä¸ç­‰äº0ï¼Œåˆ™è¾“å‡ºlogcat</span></span><br><span class="line">            <span class="keyword">if</span> (lines &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="comment">//è¾“å‡ºevets/system/main/crashè¿™äº›logä¿¡æ¯</span></span><br><span class="line">              java.lang.Process logcat = <span class="keyword">new</span> ProcessBuilder(<span class="string">&quot;/system/bin/logcat&quot;</span>,</span><br><span class="line">                      <span class="string">&quot;-v&quot;</span>, <span class="string">&quot;time&quot;</span>, <span class="string">&quot;-b&quot;</span>, <span class="string">&quot;events&quot;</span>, <span class="string">&quot;-b&quot;</span>, <span class="string">&quot;system&quot;</span>, <span class="string">&quot;-b&quot;</span>, <span class="string">&quot;main&quot;</span>,</span><br><span class="line">                      <span class="string">&quot;-b&quot;</span>, <span class="string">&quot;crash&quot;</span>,</span><br><span class="line">                      <span class="string">&quot;-t&quot;</span>, String.valueOf(lines)).redirectErrorStream(<span class="keyword">true</span>).start();</span><br><span class="line"></span><br><span class="line">              input = <span class="keyword">new</span> InputStreamReader(logcat.getInputStream());</span><br><span class="line"></span><br><span class="line">              <span class="keyword">int</span> num;</span><br><span class="line">              <span class="keyword">char</span>[] buf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">8192</span>];</span><br><span class="line">              <span class="comment">//ä¸æ–­è¯»å–inputä¸­çš„logå†…å®¹ï¼Œå¹¶æ·»åŠ åˆ°sb</span></span><br><span class="line">              <span class="keyword">while</span> ((num = input.<span class="keyword">read</span>(buf)) &gt; <span class="number">0</span>) sb.<span class="keyword">append</span>(buf, <span class="number">0</span>, num);</span><br><span class="line">              ...</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†logä¿¡æ¯è¾“å‡ºåˆ°DropBox</span></span><br><span class="line">            dbox.addText(dropboxTag, sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (process == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//å½“è¿›ç¨‹ä¸ºç©ºï¼Œæ„å‘³ç€system_serverè¿›ç¨‹å´©æºƒï¼Œç³»ç»Ÿå¯èƒ½å¾ˆå¿«å°±è¦æŒ‚äº†,</span></span><br><span class="line">        <span class="comment">//é‚£ä¹ˆä¸å†åˆ›å»ºæ–°çº¿ç¨‹ï¼Œè€Œæ˜¯ç›´æ¥åœ¨system_serverè¿›ç¨‹ä¸­åŒæ­¥è¿è¡Œ</span></span><br><span class="line">        worker.run();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//å¯åŠ¨æ–°çº¿ç¨‹</span></span><br><span class="line">        worker.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•ä¸»è¦åŠŸèƒ½æ˜¯è¾“å‡ºä»¥ä¸‹å†…å®¹é¡¹ï¼š</p>
<ul>
<li>Process,flags, packageç­‰å¤´ä¿¡æ¯ï¼›</li>
<li>å½“reportä¸ä¸ºç©ºï¼Œåˆ™æ¯”å¦‚ANRæ—¶è¾“å‡ºCpuinfoï¼Œæˆ–è€…lowmemæ—¶è¾“å‡ºçš„å†…å­˜ä¿¡æ¯</li>
<li>å½“logFileä¸ä¸ºç©ºï¼Œåˆ™æ¯”å¦‚anræˆ–è€…Watchdogæ—¶è¾“å‡ºçš„tracesæ–‡ä»¶(kill -3)ï¼Œæœ€å¤§ä¸Šé™ä¸º256KBï¼›</li>
<li>å½“stackä¸ä¸ºç©ºï¼Œåˆ™æ¯”å¦‚crashæ—¶è¾“å‡ºçš„è°ƒç”¨æ ˆï¼›</li>
<li>è¾“å‡ºlogcatçš„events&#x2F;system&#x2F;main&#x2F;crashä¿¡æ¯ã€‚</li>
</ul>
<p>AMS.processClass()æ–¹æ³•</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="type">static</span> <span class="type">String</span> <span class="title">processClass</span><span class="params">(ProcessRecord process)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//MY_PIDä»£è¡¨çš„æ˜¯å½“å‰è¿›ç¨‹pidï¼Œæ­£æ˜¯system_serverè¿›ç¨‹</span></span><br><span class="line">    <span class="keyword">if</span> (process == null || process.pid == MY_PID) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;system_server&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((process.info.flags &amp; ApplicationInfo.FLAG_SYSTEM) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;system_app&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;data_app&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>dropboxæ–‡ä»¶åæ ¼å¼ä¸º<a href="mailto:&#x64;&#x72;&#x6f;&#x70;&#98;&#x6f;&#x78;&#x54;&#x61;&#x67;&#x40;&#x78;&#120;&#x78;&#x2e;&#116;&#x78;&#x74;">&#x64;&#x72;&#x6f;&#x70;&#98;&#x6f;&#x78;&#x54;&#x61;&#x67;&#x40;&#x78;&#120;&#x78;&#x2e;&#116;&#x78;&#x74;</a> xxxä»£è¡¨æ—¶é—´æˆ³,ä¾‹å¦‚<a href="mailto:&#115;&#x79;&#115;&#x74;&#101;&#x6d;&#95;&#x73;&#101;&#114;&#x76;&#101;&#114;&#x5f;&#99;&#114;&#97;&#115;&#x68;&#64;&#49;&#x34;&#x36;&#x35;&#54;&#53;&#x30;&#x38;&#x34;&#53;&#51;&#53;&#x35;&#x2e;&#116;&#120;&#116;">&#115;&#x79;&#115;&#x74;&#101;&#x6d;&#95;&#x73;&#101;&#114;&#x76;&#101;&#114;&#x5f;&#99;&#114;&#97;&#115;&#x68;&#64;&#49;&#x34;&#x36;&#x35;&#54;&#53;&#x30;&#x38;&#x34;&#53;&#51;&#53;&#x35;&#x2e;&#116;&#120;&#116;</a>,åˆ™è®°å½•è¯¥æ–‡ä»¶æ—¶é—´æˆ³ä¸º1465650845355. æ–‡ä»¶åç¼€é™¤äº†.txtï¼Œè¿˜æœ‰å‹ç¼©æ ¼å¼.txt.gz. å¯¹äºdropboxTagæ˜¯ç”±processClass + eventTypeç»„åˆè€Œæˆ.</p>
<p>processClassåˆ†ä¸ºsystem_server, system_app, data_app;<br>eventTypeï¼šåˆ†ä¸ºcrash,anr,wtf,native_cras,lowmem, watchdog</p>
<p>åˆ—ä¸¾éƒ¨åˆ†å¸¸è§tagsä»¥åŠå«ä¹‰:</p>
<table>
<thead>
<tr>
<th>dropboxTag</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>system_server_anr</td>
<td>systemè¿›ç¨‹æ— å“åº”</td>
</tr>
<tr>
<td>system_server_watchdog</td>
<td>systemè¿›ç¨‹å‘ç”Ÿwatchdog</td>
</tr>
<tr>
<td>system_server_crash</td>
<td>systemè¿›ç¨‹å´©æºƒ</td>
</tr>
<tr>
<td>system_server_native_crash</td>
<td>systemè¿›ç¨‹nativeå‡ºç°å´©æºƒ</td>
</tr>
<tr>
<td>system_server_wtf</td>
<td>systemè¿›ç¨‹å‘ç”Ÿä¸¥é‡é”™è¯¯</td>
</tr>
<tr>
<td>system_server_lowmem</td>
<td>systemè¿›ç¨‹å†…å­˜ä¸è¶³</td>
</tr>
<tr>
<td>å½“ç„¶é™¤äº†system_serverè¿›ç¨‹, è¿˜æœ‰system_app, data_appç±»å‹çš„è¿›ç¨‹, ä»¥ä¸Šæ‰€æœ‰ç±»å‹éƒ½é€‚ç”¨,åˆ—ä¸¾éƒ¨åˆ†:</td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>dropboxTag</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>system_app_crash</td>
<td>ç³»ç»Ÿappå´©æºƒ</td>
</tr>
<tr>
<td>system_app_anr</td>
<td>ç³»ç»Ÿappæ— å“åº”</td>
</tr>
<tr>
<td>data_app_crash</td>
<td>æ™®é€šappå´©æºƒ</td>
</tr>
<tr>
<td>data_app_anr</td>
<td>æ™®é€šappæ— å“åº”</td>
</tr>
</tbody></table>
</div><div class="post-copyright"><script type="text/javascript" src="/blog/js/copyright.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸï¼"></script><link rel="stylesheet" type="text/css" href="/blog/css/copyright.css?v=1.0.0"><p><span>æœ¬æ–‡æ ‡é¢˜ï¼š</span>ANRç¨‹åºé—®é¢˜åˆ†æä¹‹dropbox</p><p><span>æ–‡ç« ä½œè€…ï¼š</span>xmaihh</p><p><span>å‘å¸ƒæ—¶é—´ï¼š</span>2018-07-14</p><p><span>æœ€åæ›´æ–°ï¼š</span>2018-07-14</p><p><span>åŸå§‹é“¾æ¥ï¼š</span><a href="/2018/07/14/anr-cheng-xu-wen-ti-fen-xi-zhi-dropbox/">https://xmaihh.github.io/blog/2018/07/14/anr-cheng-xu-wen-ti-fen-xi-zhi-dropbox/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://xmaihh.github.io/blog/2018/07/14/anr-cheng-xu-wen-ti-fen-xi-zhi-dropbox/"></i></span></p><p><span>ç‰ˆæƒå£°æ˜ï¼š</span>é‡‡ç”¨<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">[CC BY-NC-SA 4.0è®¸å¯åè®®]</a>è¿›è¡Œè®¸å¯</p></div><br><script type="text/javascript" src="/blog/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="https://xmaihh.github.io/blog/2018/07/14/anr-cheng-xu-wen-ti-fen-xi-zhi-dropbox/" data-id="cm2e1ez2r0007f1q1e14o4y6k" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACt0lEQVR42u3cwW7rMAwEwPz/T+ddC/RZWJJi4cP4FCSurVEAi1kR/Xzi4/vr+Pn++fzkmr/fP7++fODh4eGNh/7EePr0aSjJdarTkY8ZDw8Pb5uXXK734E4Yveucz8HDw8N7J+/8To8xL+Xx8PDw3sabM5LS/EzCw8PDewMvCSOSh3j59kXwYtaCh4eHF/PyXaT3vF7Z38PDw8Mb76rn2115aHt+fPc24R7/Cg8PD2+B14tTqwXxmdqLcQvjxMPDw1vg9X7w34owem1beYiMh4eHd5dXLZfzweULQ1J2V5tfP+UvFw8PD6/Dy7esqkXzpNSuti/857cCHh4e3hqvSuq9U11+LjQE4OHh4S3wJi1QvQ2zPLyYbInh4eHh7fGqQ+y1is7j4GppjoeHh/c3vL0QoRraThoXHhcGPDw8vDGv12Y6Z0zK7l7Ui4eHh7fBy1ua5o2q1Tav5I4XvkM8PDy8gJc/cPNzqgV0Pk3lbTY8PDy8BV6OrDZFJVMQbWLFjQVRDIGHh4e3wEt+/M8L4rzpat4yi4eHh3eX18stJjFuLxTuXR8PDw/vL3mTACJfPKqtA+Wufjw8PLxl3rxpIB9cvhgkvKinDA8PD+8SL9/mry4kvQUmv2NzIcHDw8O7xJsvDMng5p/mxTceHh7e3/B6DQR5e2sv5K0GIoU5xsPDw7vKyxeAazFB6/yo0MfDw8Nb4/UeytVgotd01Qs78PDw8DZ43+KxETT0WlHP43lsusLDw8Mb86oP3DzkrUYeZ1K1WaG5nuDh4eF9a/8fKY9Z55OyMZVRjIuHh4d3lVcNDm4tBpMWrmiRwMPDw3sZr7olltwlj0KiicbDw8N7AS8vwfNm02SRqAbNeHh4eNu83nB701ENIM5leqGnDA8PD+8Sr9zMNC6s88d6ObSd5xl4eHh4p+MfaeY1ythSLJQAAAAASUVORK5CYII=">åˆ†äº«</a><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/ANR/" rel="tag">ANR</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Android/" rel="tag">Android</a></li></ul></div><div class="post-nav"><a class="pre" href="/blog/2018/07/15/watchdog-ji-zhi/">Watchdogæœºåˆ¶</a><a class="next" href="/blog/2018/07/13/anr-cheng-xu-wen-ti-fen-xi-zhi-traces/">ANRç¨‹åºé—®é¢˜åˆ†æä¹‹traces</a></div><div class="nofancybox" id="vcomment"></div><script src="https://unpkg.com/valine/dist/Valine.min.js"></script><script>var notify = 'false' == 'true' ? true : false;
var verify = 'false' == 'true' ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'WyoZPeMWzhLWRYAeA5ueZwiI-MdYXbMMI',
  appKey:'2n4nqRtMlbjNwRNodC3rPRQI',
  serverURLs:'https://wyozpemw.api.lncldglobal.com',
  placeholder:'Just so so',
  avatar:'robohash',
  guest_info:guest_info,
  pageSize:'10'
})
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="å…³äº"><img class="nofancybox" src="/blog/img/avatar.svg"/></a><p>äº²è‡ªéƒ¨ç½² äº²è‡ªæŒ‡æŒ¥</p><a class="info-icon" href="https://github.com/xmaihh" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/blog/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">å­¦ä¹ ç¬”è®°</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/">æŠ€æœ¯åˆ†äº«</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/blog/tags/Android/" style="font-size: 15px;">Android</a> <a href="/blog/tags/ADB/" style="font-size: 15px;">ADB</a> <a href="/blog/tags/ANR/" style="font-size: 15px;">ANR</a> <a href="/blog/tags/BLE/" style="font-size: 15px;">BLE</a> <a href="/blog/tags/Lottie/" style="font-size: 15px;">Lottie</a> <a href="/blog/tags/OTA/" style="font-size: 15px;">OTA</a> <a href="/blog/tags/SDK/" style="font-size: 15px;">SDK</a> <a href="/blog/tags/Logcat/" style="font-size: 15px;">Logcat</a> <a href="/blog/tags/AndroidStudio/" style="font-size: 15px;">AndroidStudio</a> <a href="/blog/tags/Jni/" style="font-size: 15px;">Jni</a> <a href="/blog/tags/Serialport/" style="font-size: 15px;">Serialport</a> <a href="/blog/tags/Java/" style="font-size: 15px;">Java</a> <a href="/blog/tags/BT/" style="font-size: 15px;">BT</a> <a href="/blog/tags/RS232/" style="font-size: 15px;">RS232</a> <a href="/blog/tags/Archlinux/" style="font-size: 15px;">Archlinux</a> <a href="/blog/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/blog/tags/ArkUI/" style="font-size: 15px;">ArkUI</a> <a href="/blog/tags/Harmony/" style="font-size: 15px;">Harmony</a> <a href="/blog/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/blog/tags/Cloudflare/" style="font-size: 15px;">Cloudflare</a> <a href="/blog/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/blog/tags/docker-compose/" style="font-size: 15px;">docker-compose</a> <a href="/blog/tags/Debian/" style="font-size: 15px;">Debian</a> <a href="/blog/tags/Ubuntu/" style="font-size: 15px;">Ubuntu</a> <a href="/blog/tags/Flutter/" style="font-size: 15px;">Flutter</a> <a href="/blog/tags/Frp/" style="font-size: 15px;">Frp</a> <a href="/blog/tags/Github-Actions/" style="font-size: 15px;">Github Actions</a> <a href="/blog/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/blog/tags/CI-CD/" style="font-size: 15px;">CI/CD</a> <a href="/blog/tags/Golang/" style="font-size: 15px;">Golang</a> <a href="/blog/tags/Portainer/" style="font-size: 15px;">Portainer</a> <a href="/blog/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/blog/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/blog/tags/ArchLinux/" style="font-size: 15px;">ArchLinux</a> <a href="/blog/tags/Pixel8/" style="font-size: 15px;">Pixel8</a> <a href="/blog/tags/Magisk/" style="font-size: 15px;">Magisk</a> <a href="/blog/tags/Python/" style="font-size: 15px;">Python</a> <a href="/blog/tags/RecyclerView/" style="font-size: 15px;">RecyclerView</a> <a href="/blog/tags/Gdrive/" style="font-size: 15px;">Gdrive</a> <a href="/blog/tags/ZeroTier/" style="font-size: 15px;">ZeroTier</a> <a href="/blog/tags/Watchdog/" style="font-size: 15px;">Watchdog</a> <a href="/blog/tags/SSH/" style="font-size: 15px;">SSH</a> <a href="/blog/tags/Git/" style="font-size: 15px;">Git</a> <a href="/blog/tags/Github/" style="font-size: 15px;">Github</a> <a href="/blog/tags/Windows/" style="font-size: 15px;">Windows</a> <a href="/blog/tags/Proxy/" style="font-size: 15px;">Proxy</a> <a href="/blog/tags/Sqlite/" style="font-size: 15px;">Sqlite</a> <a href="/blog/tags/Kotlin/" style="font-size: 15px;">Kotlin</a> <a href="/blog/tags/Tailscale/" style="font-size: 15px;">Tailscale</a> <a href="/blog/tags/weixin/" style="font-size: 15px;">weixin</a> <a href="/blog/tags/Openwrt/" style="font-size: 15px;">Openwrt</a> <a href="/blog/tags/npm/" style="font-size: 15px;">npm</a> <a href="/blog/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/blog/tags/DoH/" style="font-size: 15px;">DoH</a> <a href="/blog/tags/Design-pattern/" style="font-size: 15px;">Design pattern</a> <a href="/blog/tags/Raspberry-Pi/" style="font-size: 15px;">Raspberry Pi</a> <a href="/blog/tags/VLC/" style="font-size: 15px;">VLC</a> <a href="/blog/tags/CRC/" style="font-size: 15px;">CRC</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2024/10/17/hexo-bo-ke-qi-yong-websub/">Hexoåšå®¢å¯ç”¨ WebSub</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/10/16/rang-follow-ren-zheng-wo-de-hexo-bo-ke-ding-yue-yuan/">è®©Followè®¤è¯æˆ‘çš„Hexoåšå®¢è®¢é˜…æº</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/09/10/portainer-chong-zhi-admin-deng-lu-mi-ma/">Portaineré‡ç½®adminç™»å½•å¯†ç </a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/08/02/hua-shuo-lu-you-qi-xiu-gai-hosts/">åç¡•è·¯ç”±å™¨ä¿®æ”¹Hosts</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/07/30/flutter-shi-yong-intl-generator-zai-windows-xia-bao-cuo-cannot-open-file-path-l10n-arb-intl-arb-os-error-wen-jian-ming-mu-lu-ming-huo-juan-biao-yu-fa-bu-zheng-que/">Flutterä½¿ç”¨intl_generatoråœ¨Windowsä¸‹æŠ¥é”™Cannot open file, path = 'l10n-arb/intl_*.arb' (OS Error: æ–‡ä»¶åã€ç›®å½•åæˆ–å·æ ‡è¯­æ³•ä¸æ­£ç¡®</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/07/26/zai-hexo-zhong-shi-yong-plantuml/">åœ¨Hexoä¸­ä½¿ç”¨PlantUML</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/07/26/yong-yu-gou-jian-he-fa-bu-flutter-ying-yong-cheng-xu-de-github-actions-gong-zuo-liu-cheng/">ç”¨äºæ„å»ºå’Œå‘å¸ƒ Flutter åº”ç”¨ç¨‹åºçš„GitHub Actions å·¥ä½œæµç¨‹</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/07/25/flutter-ge-ge-ping-tai-de-gou-jian-chan-wu/">Flutterå„ä¸ªå¹³å°çš„æ„å»ºäº§ç‰©</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/07/24/flutter-she-zhi-app-ban-ben/">Flutterè®¾ç½®Appç‰ˆæœ¬</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2024/07/15/windows-xia-jin-wei-github-she-zhi-ssh-dai-li/">Windowsä¸‹ä»…ä¸º GitHub è®¾ç½®SSHä»£ç†</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://quincyjiang.github.io/" title="ç˜Ÿç–«é’å¹´" target="_blank">ç˜Ÿç–«é’å¹´</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2024 <a href="/blog/." rel="nofollow">å°éº¦.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="https://unpkg.com/@fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/blog/css/search.css?v=1.0.0"><script type="text/javascript" src="/blog/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="100,99,98" opacity="0.7" zIndex="-1" count="150" src="https://unpkg.com/canvas-nest.js/dist/canvas-nest.js"></script><script type="text/javascript" src="/blog/js/love.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/copycode.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸï¼"></script><link rel="stylesheet" type="text/css" href="/blog/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=1.0.0"></script></div></body></html>